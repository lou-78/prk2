{
  "summary": {
    "title": "Bedrohungsmodell - OTT Auth",
    "owner": "Firma Allsecure",
    "description": "Die Firma Allsecure betreibt unterschiedliche Anwendungen mit Hilfe einer 2-Faktorauthentifizierung via One-time token, der an das entsprechende Smartphone des Nutzers geschickt wird."
  },
  "detail": {
    "contributors": [
      {
        "name": "Georg Neugebauer",
        "$$hashKey": "object:14"
      },
      {
        "name": "alla hidri",
        "$$hashKey": "object:16"
      }
    ],
    "diagrams": [
      {
        "cells": [
          {
            "position": {
              "x": 12,
              "y": 53
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "User"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "f7854f85-626e-4bc7-9d41-814b27f56b2f"
                },
                {
                  "group": "right",
                  "id": "441c8615-fb4b-4b84-9f2a-dfc5ca0d0cb5"
                },
                {
                  "group": "bottom",
                  "id": "3a7dd1f5-baa5-4a10-92b3-79b66bc001d7"
                },
                {
                  "group": "left",
                  "id": "2c6d3418-c9bd-475e-bb74-5e19ac1bc8a4"
                }
              ]
            },
            "id": "dec51efb-bf55-4b9c-a294-0e45f4e823f6",
            "data": {
              "name": "User",
              "description": "",
              "type": "tm.Actor",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [],
              "hasOpenThreats": false,
              "providesAuthentication": false
            }
          },
          {
            "position": {
              "x": 245,
              "y": -46.999999999999915
            },
            "size": {
              "width": 130,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Login System -\nWebapp +\nMobile App"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 2,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "3fe1dace-a665-41fd-8852-049b8ac152c1"
                },
                {
                  "group": "right",
                  "id": "e9a1e90e-c8d0-44e3-bce6-5736625655e8"
                },
                {
                  "group": "bottom",
                  "id": "2390e2fb-cff6-481c-9bca-4c5ce854bc19"
                },
                {
                  "group": "left",
                  "id": "0e4de59e-46fa-439e-84a2-176fa671dd5e"
                }
              ]
            },
            "id": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa",
            "data": {
              "name": "Login System -\nWebapp +\nMobile App",
              "description": "Vergleicht eingegebenen OTT-Wert auf Telefon mit erwartetem OTT seitens 2-Faktor-Dienst. ",
              "type": "tm.Process",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "id": "49eaf072-ffef-429a-b519-fcaa6200de4b",
                  "title": "DDoS",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Ein DDoS Angriff kann den Login-Dienst überlasten und somit für Anwender unerreichbar machen. \n\nCAPEC-125: Flooding: An adversary consumes the resources of a target by rapidly engaging in a large number of interactions with the target.\n\nATT&CK: TA0038 - Network Effects: The adversary is trying to intercept or manipulate network traffic to or from a device.\n\nD: 8 / R: 10 / E: 8 / A: 10 / DREA: 36",
                  "mitigation": "Firewall, Load-Balancer oder CDN einsetzen, um direkten Datenverkehr auf Login-Server zu begrenzen.\n\nDEFEND: D3-ITF - Inbound Traffic Filtering\nASVS: CWE 770 (8.1.4): Verify the application can detect and alert on abnormal numbers of requests, such as by IP, user, total per hour or day, or whatever makes sense for the application.\n\nD: 4 / R: 10 / E: 4 / A: 10 / Neuer DREA: 28",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 101,
                  "score": "28"
                },
                {
                  "id": "7d3734b5-166d-4753-8d86-61d52d0f9b77",
                  "title": "dev",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Ein Angreifer benutzt gestohlene oder erratene Zugangsdaten (Username/Passwort), um sich als legitimer Allsecure-Nutzer am Login-System anzumelden und dadurch einen gültigen OTT zu erhalten.\nAngriffsvektor: Credential Stuffing / Passwort-Brute-Force gegen die öffentliche Login-Schnittstelle (viele Login-Versuche ohne genügend Rate-Limiting oder Account-Sperre).\nCAPEC: CAPEC-653 – Use of Known OS Credentials\nATT&CK: T1078 – Valid Accounts (Taktik: Credential Access / Initial Access)\n",
                  "mitigation": "Starke Authentisierung und Schutz gegen Brute-Force: Rate-Limiting pro Benutzer/IP, Account-Lockout nach mehreren Fehlversuchen, verpflichtende 2-Faktor-Authentisierung und Überwachung auffälliger Login-Muster durch das SIEM.\nASVS: V2 – Authentication (z.B. Schutz gegen Brute-Force und starke Passwortrichtlinien)\nD3FEND: Multi-Factor Authentication / Rate Limiting (allgemein für Schutz vor Credential Stuffing)\nD (alt): 8 / R: 7 / E: 7 / A: 8  → alter DREA: 30\nD (neu): 7 / R: 3 / E: 3 / A: 5  → neuer DREA: 18\nPriorität nach Mitigation: Medium\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 103,
                  "score": "18"
                }
              ],
              "hasOpenThreats": false,
              "isWebApplication": null,
              "handlesCardPayment": null,
              "threatFrequency": {
                "spoofing": 3,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              },
              "handlesGoodsOrServices": null
            }
          },
          {
            "position": {
              "x": 566,
              "y": -31.999999999999915
            },
            "size": {
              "width": 130,
              "height": 140
            },
            "attrs": {
              "text": {
                "text": "2-Faktor-Authe\nntifizierungsdi\nenst"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "dbd4f10d-9b93-47aa-bc18-c0198618cd0f"
                },
                {
                  "group": "right",
                  "id": "efd7dd72-66a3-4a36-8f21-8d4cbd9ad0c2"
                },
                {
                  "group": "bottom",
                  "id": "335431e7-ced9-4931-9ab6-a8e36d69cb33"
                },
                {
                  "group": "left",
                  "id": "7a2c7f58-9e83-484f-a905-5d99d61d38ca"
                }
              ]
            },
            "id": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c",
            "data": {
              "name": "2-Faktor-Authe\nntifizierungsdi\nenst",
              "description": "",
              "type": "tm.Process",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "id": "def2a9cb-c7de-4442-b86c-34f44c41c4d7",
                  "title": "Repudiation durch unvollständige oder änderbare Logs",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "Ein Benutzer oder Admin führt sicherheitsrelevante Aktionen (z.B. viele fehlgeschlagene Logins, verdächtige Exporte) aus und bestreitet später alles, weil die Protokollierung unvollständig ist oder Log-Einträge nachträglich verändert bzw. gelöscht wurden.\n\nAngriffsvektor: Deaktivieren oder Umgehen der Protokollierung in der Anwendung oder Manipulation/Löschung bestimmter Log-Einträge nach dem Angriff.\n\nCAPEC: CAPEC-268 – Audit Log Manipulation (führt zu fehlender Accountability / Non-Repudiation)\nATT&CK: T1070 – Indicator Removal on Host\n\nDREA (vor Mitigation): D=7 / R=8 / E=6 / A=6 → 27 (High)\n",
                  "mitigation": "Vollständige, signierte und zentralisierte Logs: alle sicherheitsrelevanten Events (Logins, 2FA-Events, Admin-Aktionen) zentral loggen, Log-Einträge digital signieren bzw. mit HMAC schützen, Zeitstempel mit NTP synchronisieren und klare organisatorische Regeln zur Aufbewahrung und Auswertung der Logs definieren.\n\nASVS: V8 – Logging (Integrity und Vollständigkeit der Protokollierung sicherstellen)\nD3FEND: Secure Logging Practices / Log Integrity\n\nDREA (nach Mitigation): D=4 / R=3 / E=3 / A=3 → 13\nPriorität nach Mitigation: Low\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 105,
                  "score": "13"
                },
                {
                  "id": "70468319-cbaa-487a-8ae0-5d8a10390643",
                  "title": "DoS auf den 2-Faktor-Authentifizierungsdienst",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Der 2-Faktor-Authentifizierungsdienst ist nicht redundant ausgelegt. Ein Angreifer überlastet den Dienst mit sehr vielen künstlichen Auth-Anfragen, sodass legitime Nutzer keinen OTT mehr erhalten und sich nicht einloggen können.\n\nAngriffsvektor: Automatisierte HTTP-Requests (Flooding) gegen die 2FA-API ohne ausreichendes Rate-Limiting oder Volumen-Überwachung.\n\nCAPEC: CAPEC-125 – Flooding\nATT&CK: T1499 – Endpoint Denial of Service (Taktik: Impact)\n\nDREA (vor Mitigation): D=7 / R=9 / E=8 / A=9 → 33 (High)\n",
                  "mitigation": "Rate-Limiting und Traffic-Filter: API-Gateway mit globalem und per-IP Rate-Limiting vor dem 2FA-Dienst, Erkennung ungewöhnlich hoher Anfragezahlen, automatisches Blocken/Throttling von verdächtigen IP-Adressen und horizontale Skalierung des 2FA-Dienstes.\n\nD3FEND: D3-ITF – Inbound Traffic Filtering, D3-ISVA – Inbound Session Volume Analysis\nASVS: V1/V2 – Schutz vor Missbrauch der Schnittstellen (Rate-Limits, Alarmierung)\n\nDREA (nach Mitigation): D=6 / R=3 / E=3 / A=6 → 18\nPriorität nach Mitigation: Medium\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 108,
                  "score": "18"
                }
              ],
              "hasOpenThreats": false,
              "isBidirectional": false,
              "protocol": "",
              "isEncrypted": false,
              "isPublicNetwork": false,
              "handlesCardPayment": null,
              "isWebApplication": null,
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 2,
                "informationDisclosure": 0,
                "denialOfService": 2,
                "elevationOfPrivilege": 0
              },
              "handlesGoodsOrServices": null
            }
          },
          {
            "position": {
              "x": 571,
              "y": 266
            },
            "size": {
              "width": 120,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Kundentelefon-\nanbieter"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 5,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "ee829222-9cb4-483a-a541-566dace970b7"
                },
                {
                  "group": "right",
                  "id": "7d7cd0d2-0cb9-4dad-835c-80469bbc6057"
                },
                {
                  "group": "bottom",
                  "id": "265083fc-3b93-423a-80e8-412615d92c1e"
                },
                {
                  "group": "left",
                  "id": "225654fb-97e7-4f2e-894e-f27ac13e574b"
                }
              ]
            },
            "id": "fd7303e8-29d2-4d76-bf7d-87eb619ede69",
            "data": {
              "name": "Kundentelefon-\nanbieter",
              "description": "",
              "type": "tm.Process",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "id": "31607411-287a-47ff-b617-eba251187f8c",
                  "title": "Spoofing von Kundendaten",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Spoofing",
                  "description": "Angreifer kann sich als \"legitimer\" Kunde ausgeben, um an kritische Daten / Dienste zu gelangen zu denen er eigentlich keinen Zugriff haben dürfte (Social Engineering beim Kundendienst).\n\nCAPEC ID: 148: Content Spoofing: An adversary modifies content to make it contain something other than what the original content producer intended while keeping the apparent source of the content unchanged.\nAtt&ck: T1557 (Adversary-in-the-Middle)\n\nD: 9 / R: 8 / E: 5 / A: 4 / DREA: 26",
                  "mitigation": "Personal schulen, Kritische Kundendaten als solche für Mitarbeiter in der Support-Software markieren, um Irrtümer zu vermeiden. \n\nDefend Matrix: D3-NTCD: Network Traffic Community Deviation\nASVS: 1.8.1 : Verify that all sensitive data is identified and classified into protection levels.\n\nD: 4 / R: 4 / E: 2 / A: 4 / Neuer DREA: 14",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 102,
                  "score": "14"
                }
              ],
              "hasOpenThreats": false,
              "isBidirectional": false,
              "protocol": "",
              "isEncrypted": false,
              "isPublicNetwork": false,
              "handlesCardPayment": null,
              "handlesGoodsOrServices": null
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "1. Auth Challenge",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Login"
                  }
                },
                "position": 0.5
              }
            ],
            "id": "35f9f840-c060-4c31-bf9a-0e17a95ddf66",
            "source": {
              "cell": "dec51efb-bf55-4b9c-a294-0e45f4e823f6"
            },
            "target": {
              "cell": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa"
            },
            "vertices": [
              {
                "x": 237,
                "y": 39
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Erwarteter OTT",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "1. Auth Challenge"
                  }
                },
                "position": 0.5
              }
            ],
            "id": "2503a360-01b6-4464-b35f-42c6fb583348",
            "source": {
              "cell": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa"
            },
            "target": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c"
            },
            "vertices": [
              {
                "x": 440,
                "y": -10
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "2. Weiterleitung\nTelefonnummer",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Erwarteter OTT"
                  }
                },
                "position": 0.5
              }
            ],
            "id": "63356151-e316-4a82-8224-9a7c729cfbee",
            "source": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c"
            },
            "target": {
              "cell": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "2a. Telefonnummer",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Telefonnummer, OTT"
                  }
                },
                "position": 0.5
              }
            ],
            "id": "3f9c3edd-4fe5-4fc4-9239-2ca13291fc25",
            "source": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c"
            },
            "target": {
              "cell": "fd7303e8-29d2-4d76-bf7d-87eb619ede69"
            },
            "vertices": []
          },
          {
            "shape": "trust-broundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Externer Service für T\nelefonnummernauflö\nsung",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Firma Allsecure"
                  }
                },
                "position": {
                  "distance": 0,
                  "offset": 25.336937022630487
                }
              }
            ],
            "id": "8c690a8a-f100-4c4d-bd88-095a530ac220",
            "source": {
              "x": 241,
              "y": 135
            },
            "target": {
              "x": 246,
              "y": 138
            },
            "vertices": [
              {
                "x": 623,
                "y": 156
              },
              {
                "x": 720,
                "y": -50
              },
              {
                "x": 680,
                "y": -310
              },
              {
                "x": 310,
                "y": -280
              },
              {
                "x": 243,
                "y": -8
              }
            ]
          },
          {
            "shape": "trust-broundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Externer Service für\nden Versand des OTT",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Telefonanbieter"
                  }
                },
                "position": {
                  "distance": 0.1607609674711048,
                  "offset": 15.4290577443574
                }
              }
            ],
            "id": "5d5f2170-50ee-404a-99f3-b55e2f657730",
            "source": {
              "x": 540,
              "y": 259
            },
            "target": {
              "x": 539,
              "y": 259
            },
            "vertices": [
              {
                "x": 460,
                "y": 259
              },
              {
                "x": 390,
                "y": 305
              },
              {
                "x": 420,
                "y": 394
              },
              {
                "x": 685,
                "y": 394
              },
              {
                "x": 710,
                "y": 266
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Log(Login, OTT, Phone Number)",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Log(Login, OTT, Phone Number)"
            ],
            "id": "81c8482c-19ed-41ab-bae2-a5561223b4b5",
            "source": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c"
            },
            "target": {
              "cell": "c2716661-ef88-48a8-8d0f-724e1923d562"
            },
            "vertices": [
              {
                "x": 559.5,
                "y": -60
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Nummer auslesen",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Nummer auslesen"
            ],
            "id": "173e6c33-8e25-4c5e-bc33-9c78bbdeaaad",
            "source": {
              "cell": "fd7303e8-29d2-4d76-bf7d-87eb619ede69"
            },
            "target": {
              "cell": "2e16a416-e822-44a0-8501-2d54aa8add4f"
            },
            "vertices": [
              {
                "x": 560,
                "y": 465
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "signiert und verschlusselt",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "signiert und verschlusselt"
            ],
            "id": "bc1b8fa0-d8d5-43de-81b2-a9925dec203d",
            "source": {
              "cell": "eedcac5f-2c94-480e-aeb7-541791a52249",
              "port": "65a0ff82-6125-4ae6-8e5c-16f650a01322"
            },
            "target": {
              "cell": "d9a598f9-c8e1-4118-9703-1bfc35e252ae",
              "port": "47285afd-f424-4288-86d9-4acb55167a50"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "logs speichern",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "logs speichern"
            ],
            "id": "2c6f2877-4761-4d19-8eb3-66eb2ddae294",
            "source": {
              "cell": "d9a598f9-c8e1-4118-9703-1bfc35e252ae",
              "port": "5a84fbe7-8d00-42ed-b262-1146ebe00157"
            },
            "target": {
              "cell": "be1c61c9-f4dc-4e74-8744-8b38997cde66",
              "port": "9dc11795-f64c-423b-bc0b-862a2bb4430d"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "ath log/security events \n",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "ath log/security events \n"
            ],
            "id": "971609a9-53e7-4d91-9044-87f04b31fdea",
            "source": {
              "cell": "d9a598f9-c8e1-4118-9703-1bfc35e252ae",
              "port": "69d4105b-2238-46b6-b061-e8c4c9262f80"
            },
            "target": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c",
              "port": "dbd4f10d-9b93-47aa-bc18-c0198618cd0f"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Login System – WebApp + Mobile App",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Login System – WebApp + Mobile App"
            ],
            "id": "7b80a576-18c0-4012-90d3-2b1cfef3e50e",
            "source": {
              "cell": "dec51efb-bf55-4b9c-a294-0e45f4e823f6",
              "port": "f7854f85-626e-4bc7-9d41-814b27f56b2f"
            },
            "target": {
              "cell": "a294821f-05a1-4bf0-85a0-8d1c0f9a3870",
              "port": "47285afd-f424-4288-86d9-4acb55167a50"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "OTT + Telefonnummer\n",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "OTT + Telefonnummer\n"
            ],
            "id": "ce296c0f-0cfe-4271-b948-9c7d38aaaa96",
            "source": {
              "cell": "fd7303e8-29d2-4d76-bf7d-87eb619ede69",
              "port": "225654fb-97e7-4f2e-894e-f27ac13e574b"
            },
            "target": {
              "cell": "a294821f-05a1-4bf0-85a0-8d1c0f9a3870",
              "port": "5a84fbe7-8d00-42ed-b262-1146ebe00157"
            },
            "vertices": [
              {
                "x": 240,
                "y": 200
              },
              {
                "x": 440,
                "y": 80
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Wöchentlicher Report (E-Mail, signiert & verschlüsselt)\n",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Wöchentlicher Report (E-Mail, signiert & verschlüsselt)\n"
            ],
            "id": "9a2deb5f-f788-4e46-86cd-ab01726443ae",
            "source": {
              "cell": "d9a598f9-c8e1-4118-9703-1bfc35e252ae",
              "port": "5a84fbe7-8d00-42ed-b262-1146ebe00157"
            },
            "target": {
              "cell": "eedcac5f-2c94-480e-aeb7-541791a52249",
              "port": "98427460-789f-476c-9540-1b5c66f06609"
            },
            "vertices": [
              {
                "x": 260,
                "y": -390
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "OTT / Nachricht ans Handy",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "OTT / Nachricht ans Handy"
            ],
            "id": "13a1d3c0-1953-4d80-8cc7-491a32fb0a99",
            "source": {
              "cell": "a294821f-05a1-4bf0-85a0-8d1c0f9a3870",
              "port": "69d4105b-2238-46b6-b061-e8c4c9262f80"
            },
            "target": {
              "cell": "fd7303e8-29d2-4d76-bf7d-87eb619ede69",
              "port": "ee829222-9cb4-483a-a541-566dace970b7"
            },
            "vertices": [
              {
                "x": 690,
                "y": 190
              }
            ]
          },
          {
            "position": {
              "x": 350,
              "y": -300
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Log-DB"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 11,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "f8499957-2243-4b68-af16-9d0c613d6c70"
                },
                {
                  "group": "right",
                  "id": "92b58dd8-7376-4005-a5f2-be6d4fd2cafc"
                },
                {
                  "group": "bottom",
                  "id": "5c605800-da65-4fc1-84d1-9709d2e3fb43"
                },
                {
                  "group": "left",
                  "id": "44ffca7a-a165-4947-83c8-e8e8c32f852f"
                }
              ]
            },
            "id": "c2716661-ef88-48a8-8d0f-724e1923d562",
            "data": {
              "type": "tm.Store",
              "name": "Log-DB",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "isALog": true,
              "storesCredentials": false,
              "isEncrypted": true,
              "isSigned": true,
              "hasOpenThreats": false,
              "threats": [
                {
                  "id": "844683cf-da7a-4012-8173-f49a97091d6a",
                  "title": "Manipulation der Log-DB",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Ein Angreifer mit Zugriff auf die Log-DB manipuliert oder löscht Log-Einträge zu Login- und 2-Faktor-Vorgängen, um Spuren eines Angriffs zu verwischen und Auswertungen zu verfälschen.\n\nAngriffsvektor: Kompromittiertes Admin-Konto oder unsichere DB-Konfiguration ermöglicht direkte UPDATE/DELETE-Statements auf den Log-Tabellen.\n\nCAPEC: CAPEC-268 – Audit Log Manipulation\nATT&CK: T1070 – Indicator Removal on Host (Löschen/Verändern von Logs zur Defense Evasion)\n\nDREA (vor Mitigation): D=8 / R=8 / E=6 / A=7 → 29 (High)\n",
                  "mitigation": "Zentrale, manipulationssichere Protokollierung: Logs auf einem append-only Log-Server speichern, File-/DB-Integrity-Monitoring (Prüfsummen/HMAC) für Log-Dateien, strenges RBAC (nur Lesen, kein direktes Löschen) und Protokollierung aller administrativen Aktionen auf der Log-DB.\n\nD3FEND: D3-FIM – File Integrity Monitoring\nASVS: V8 – Error Handling and Logging (Schutz der Logs vor unbefugter Änderung)\n\nDREA (nach Mitigation): D=7 / R=3 / E=3 / A=5 → 18\nPriorität nach Mitigation: Medium\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 104,
                  "score": "18"
                }
              ],
              "storesInventory": null,
              "threatFrequency": {
                "tampering": 2,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 421,
              "y": 311
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Telefonnummern-DB"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 12,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "28f6d662-0277-4db0-94ec-de5c8b96f93c"
                },
                {
                  "group": "right",
                  "id": "25ac8e5c-39ee-45f3-8ce8-742389df3c28"
                },
                {
                  "group": "bottom",
                  "id": "f355d042-ab3a-493d-bcb9-23847d0dc037"
                },
                {
                  "group": "left",
                  "id": "b7929743-d44e-479c-a1d9-f41eae0121a6"
                }
              ]
            },
            "id": "2e16a416-e822-44a0-8501-2d54aa8add4f",
            "data": {
              "type": "tm.Store",
              "name": "Telefonnummern-DB",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "isALog": false,
              "storesCredentials": false,
              "isEncrypted": false,
              "isSigned": false,
              "hasOpenThreats": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 60,
              "y": -284
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "management\n"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 14,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "98427460-789f-476c-9540-1b5c66f06609"
                },
                {
                  "group": "right",
                  "id": "65a0ff82-6125-4ae6-8e5c-16f650a01322"
                },
                {
                  "group": "bottom",
                  "id": "515bb2a2-f6c7-4f50-8bc4-abf36e9b2da1"
                },
                {
                  "group": "left",
                  "id": "81cd53f7-5d43-4a1b-a12f-9c18d1ecd4ae"
                }
              ]
            },
            "id": "eedcac5f-2c94-480e-aeb7-541791a52249",
            "data": {
              "type": "tm.Actor",
              "name": "management\n",
              "description": "",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 571,
              "y": -255
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "SIEM-DB"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 15,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "45f70651-e4df-488f-952c-d0a42c31eb01"
                },
                {
                  "group": "right",
                  "id": "85438d30-a119-491b-93a6-f222bd243f53"
                },
                {
                  "group": "bottom",
                  "id": "9dc11795-f64c-423b-bc0b-862a2bb4430d"
                },
                {
                  "group": "left",
                  "id": "f6b924de-7e0b-48b4-8c2e-77bf39d594cd"
                }
              ]
            },
            "id": "be1c61c9-f4dc-4e74-8744-8b38997cde66",
            "data": {
              "type": "tm.Store",
              "name": "SIEM-DB",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "bbadd329-01e2-4bf9-bc38-96f0bfce20d2",
                  "title": "Information Disclosure aus der SIEM-DB",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Die SIEM-DB speichert zentrale Logs mit sensiblen Informationen (z.B. Telefonnummern, IP-Adressen, Login-Muster). Ein Angreifer mit Zugriff auf die SIEM-DB kann diese Daten auslesen und vertrauliche Kunden- und Systeminformationen gewinnen.\n\nAngriffsvektor: Kompromittiertes SIEM-Admin-Konto oder Ausnutzen einer Schwachstelle im Datenbank-Server führt zu unautorisierten SELECT-Abfragen auf SIEM-Tabellen.\n\nCAPEC: CAPEC-37 – Retrieve Embedded Sensitive Data\nATT&CK: T1213.006 – Data from Information Repositories: Databases\n\nDREA (vor Mitigation): D=9 / R=7 / E=6 / A=9 → 31 (High)\n",
                  "mitigation": "Datenminimierung und Verschlüsselung: nur notwendige Informationen loggen (z.B. Hash statt Klartext-Telefonnummer, kein kompletter OTT), SIEM-DB verschlüsseln (at rest), Zugriff nur über den SIEM-Service-User erlauben und das SIEM-Netzwerk segmentieren (nur aus dem Admin-Netz erreichbar).\n\nMASVS: STORAGE-3 / Privacy – keine sensiblen Daten ungeschützt in Logs speichern\nASVS: V9 – Data Protection (Schutz vertraulicher Daten in Speicherung und Transport)\n\nDREA (nach Mitigation): D=7 / R=3 / E=3 / A=6 → 19\nPriorität nach Mitigation: Medium\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 107,
                  "score": "19"
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 2,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 250,
              "y": -170
            },
            "size": {
              "width": 120,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "allsecure\n Mobile phone \nOTT Service "
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 16,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a84fbe7-8d00-42ed-b262-1146ebe00157"
                },
                {
                  "group": "right",
                  "id": "2d56341b-e36e-408b-8b07-254d35419f55"
                },
                {
                  "group": "bottom",
                  "id": "69d4105b-2238-46b6-b061-e8c4c9262f80"
                },
                {
                  "group": "left",
                  "id": "47285afd-f424-4288-86d9-4acb55167a50"
                }
              ]
            },
            "id": "a294821f-05a1-4bf0-85a0-8d1c0f9a3870",
            "data": {
              "type": "tm.Process",
              "name": "allsecure\n Mobile phone \nOTT Service ",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            },
            "children": [
              "cb745821-a479-402d-a05b-3c86e4400099"
            ]
          },
          {
            "position": {
              "x": 618,
              "y": -180
            },
            "size": {
              "width": 100,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "SIEM_system"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 17,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a84fbe7-8d00-42ed-b262-1146ebe00157"
                },
                {
                  "group": "right",
                  "id": "2d56341b-e36e-408b-8b07-254d35419f55"
                },
                {
                  "group": "bottom",
                  "id": "69d4105b-2238-46b6-b061-e8c4c9262f80"
                },
                {
                  "group": "left",
                  "id": "47285afd-f424-4288-86d9-4acb55167a50"
                }
              ]
            },
            "id": "d9a598f9-c8e1-4118-9703-1bfc35e252ae",
            "data": {
              "type": "tm.Process",
              "name": "SIEM_system",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "2d51dca2-5a92-4ca3-a2af-0f0a4f0602c9",
                  "title": "Privilege Escalation im SIEM-System",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "Ein Angreifer nutzt eine Schwachstelle oder Fehlkonfiguration im SIEM-System, um von einem normalen Benutzerkonto zu einem SIEM-Admin mit Vollzugriff auf alle Security-Daten und Regeln aufzusteigen. Danach kann er Erkennungsregeln deaktivieren und Logs manipulieren.\n\nAngriffsvektor: Exploit einer Web-Interface-Schwachstelle oder falsche Rollen-/Rechte-Konfiguration (z.B. zu breite „Power User“-Rolle), anschließend Änderung von SIEM-Regeln und -Reports.\n\nCAPEC: CAPEC-233 – Privilege Escalation\nATT&CK: T1068 – Exploitation for Privilege Escalation\n\nDREA (vor Mitigation): D=8 / R=7 / E=6 / A=7 → 28 (High)\n",
                  "mitigation": "Striktes Rollen- und Rechtemodell (Least Privilege): getrennte SIEM-Admin-Konten mit MFA, klare Rollen (Viewer, Analyst, Admin) mit minimal nötigen Rechten, Logging aller Konfigurationsänderungen und regelmäßige Rechte-Reviews.\n\nASVS: V4 – Access Control (rollenbasierte Zugriffskontrolle und Least Privilege)\nD3FEND: Hardened Authentication and Authorization Practices\n\nDREA (nach Mitigation): D=7 / R=3 / E=3 / A=5 → 18\nPriorität nach Mitigation: Medium\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 109,
                  "score": "18"
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 2
              }
            }
          }
        ],
        "version": "2.5.0",
        "title": "Architekturdiagramm",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "id": 0,
        "diagramType": "STRIDE"
      }
    ],
    "reviewer": "Georg Neugebauer",
    "diagramTop": 10,
    "threatTop": 109
  },
  "version": "2.5.0"
}
